{"version":3,"file":"rum-maker.js.map","sources":["../src/index.js"],"sourcesContent":["console.log('@rumMaker index')\n\n//import * as babel from '@babel/core'\nimport fs from 'fs'\nconst pkg = JSON.parse(fs.readFileSync('./package.json', \"utf8\"))\nconst DEFAULTS = {\n  tasks: [\n    {\n      entry: './src/index.js',\n      target: {\n        esm: true,\n        umd: true,\n        cjs: true\n      }\n    },\n  ]\n}\nconst opts = Object.assign({}, DEFAULTS)\nif (pkg.rum && pkg.rum.maker) Object.assign(opts, pkg.rum.maker)\n//else throw \"No rum.maker entry within package.json.\"\n\nconsole.log(opts)\n\nconst filename = opts.tasks[0].entry\n\n//const code = fs.readFileSync(filename, \"utf8\");\n\n/*\nbabel.transform(\n  code,\n  {\n    filename,\n    presets: [\"@babel/preset-env\"],\n    babelrc: false,\n    configFile: false,\n  },\n  (err, result) => {\n    console.log(\n      result.code,\n      result.map,\n      result.ast\n    )\n  }\n);\n*/\nimport babel from 'rollup-plugin-babel'\nimport commonjs from 'rollup-plugin-commonjs'\nimport resolve from 'rollup-plugin-node-resolve'\n//import \"@babel/polyfill\";\n\n\nlet external = []\nif (pkg.devDependencies) external.push(...Object.keys(pkg.devDependencies))\nif (pkg.dependencies) external.push(...Object.keys(pkg.dependencies))\nconst browser = !!pkg.browser\nconst main = !!pkg.main //cjs module\nconst module = !!pkg.module // esm module\n\nimport * as rollup from 'rollup'\nconst jobs = [\n  {\n    in:{\n      input: filename,\n      external,\n      plugins: [\n        babel({\n          presets: [\n            \"@babel/preset-env\"\n          ],\n          babelrc: false,\n          configFile: false,\n          externalHelpers: false,\n          runtimeHelpers: true,\n          sourceMaps: true\n        }),\n        resolve({\n          preferBuiltins: true\n        }),\n        commonjs()\n      ]\n    },\n    out: [\n      {\n        file: pkg.main,\n        format: 'cjs',\n        sourcemap: true,\n        sourcemapFile: pkg.main+'.map'\n      },\n      {\n        file: pkg.module,\n        format: 'es',\n        sourcemap: true,\n        sourcemapFile: pkg.module+'.map'\n      }\n    ]\n  },\n  {\n    in:{\n      input: filename,\n      external: external,\n      plugins: [\n        babel({\n          presets: [\n            \"@babel/preset-env\"\n          ],\n          babelrc: false,\n          configFile: false,\n          externalHelpers: false,\n          runtimeHelpers: true,\n          sourceMaps: true\n        }),\n        resolve({\n          browser: true\n        }),\n        commonjs()\n      ]\n    },\n    out: [\n      {\n        file: pkg.browser,\n        format: 'cjs',\n        sourcemap: true,\n        sourcemapFile: pkg.browser+'.map'\n      }\n    ]\n  }\n\n]\n\n\n\nfunction build() {\n  // create a bundle\n  jobs.forEach((job) => {\n    rollup.rollup(job.in).then(bundle=>{\n      //console.log(bundle.imports); // an array of external dependencies\n      //console.log(bundle.exports); // an array of names exported by the entry point\n      //console.log(bundle.modules); // an array of module objects\n\n        console.log(bundle)\n      job.out.forEach((out) => {\n        bundle.generate(out).then((gen)=>{\n        //  console.log(gen)\n          if (out.file) bundle.write(out);\n        })\n      })\n    })\n  })\n    // generate code and a sourcemap\n    //const { code, map } = await\n\n  //})\n\n\n  // or write the bundle to disk\n  //await\n}\n\nbuild();\n\n\n/*\n//console.log(code)\n// Load and compile file normally, but skip code generation.\nconst { ast } = babel.transformSync(code, { filename, ast: true,\npresets: [\"@babel/preset-env\"], code: false });\nconsole.log(ast)\n// Minify the file in a second pass and generate the output code here.\nconst { code2, map } = babel.transformFromAstSync(ast, code, {\n  filename,\n  presets: [\"@babel/preset-env\"],\n  babelrc: false,\n  configFile: false,\n});\nconsole.log(code2)\n*/\n"],"names":["console","log","pkg","JSON","parse","fs","readFileSync","DEFAULTS","tasks","entry","target","esm","umd","cjs","opts","Object","assign","rum","maker","filename","external","devDependencies","push","keys","dependencies","browser","main","module","jobs","in","input","plugins","babel","presets","babelrc","configFile","externalHelpers","runtimeHelpers","sourceMaps","resolve","preferBuiltins","commonjs","out","file","format","sourcemap","sourcemapFile","build","forEach","job","rollup","then","bundle","generate","gen","write"],"mappings":"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"}