{"version":3,"file":"rum-maker.js","sources":["../src/index.js"],"sourcesContent":["console.log('@rumMaker index')\n\n//import * as babel from '@babel/core'\nimport fs from 'fs'\nimport * as rollup from 'rollup'\nimport babel from 'rollup-plugin-babel'\nimport commonjs from 'rollup-plugin-commonjs'\nimport resolve from 'rollup-plugin-node-resolve'\n\nconst pkg = JSON.parse(fs.readFileSync('./package.json', \"utf8\"))\nconst DEFAULTS = {\n  entry: 'src/index.js',\n}\nconst opts = Object.assign({}, DEFAULTS)\nif (pkg.rum && pkg.rum.maker) Object.assign(opts, pkg.rum.maker)\nconst filename = opts.entry\n\nlet external = []\nif (pkg.devDependencies) external.push(...Object.keys(pkg.devDependencies))\nif (pkg.dependencies) external.push(...Object.keys(pkg.dependencies))\nconst jobs = [\n  {\n    in:{\n      input: filename,\n      external,\n      plugins: [\n        babel({\n          presets: [\n            \"@babel/preset-env\"\n          ],\n          babelrc: false,\n          configFile: false,\n          externalHelpers: false,\n          runtimeHelpers: true\n        }),\n        resolve({\n          preferBuiltins: true\n        }),\n        commonjs()\n      ]\n    },\n    out: [\n      {\n        file: pkg.main,\n        format: 'cjs',\n        sourcemap: true,\n      },\n      {\n        file: pkg.module,\n        format: 'es',\n        sourcemap: true,\n      }\n    ]\n  },\n  {\n    in:{\n      input: filename,\n      external: external,\n      plugins: [\n        babel({\n          presets: [\n            \"@babel/preset-env\"\n          ],\n          babelrc: false,\n          configFile: false,\n          externalHelpers: false,\n          runtimeHelpers: true\n        }),\n        resolve({\n          browser: true\n        }),\n        commonjs()\n      ]\n    },\n    out: [\n      {\n        file: pkg.browser,\n        format: 'cjs',\n        sourcemap: true,\n      }\n    ]\n  }\n]\n\nfunction build() {\n  jobs.forEach((job) => {\n    rollup.rollup(job.in).then(bundle=>{\n      job.out.forEach((out) => {\n        //console.log(bundle)\n        if (out.file) bundle.write(out)\n      })\n    })\n  })\n}\n\nbuild();\n"],"names":["console","log","pkg","JSON","parse","fs","readFileSync","DEFAULTS","entry","opts","Object","assign","rum","maker","filename","external","devDependencies","push","keys","dependencies","jobs","in","input","plugins","babel","presets","babelrc","configFile","externalHelpers","runtimeHelpers","resolve","preferBuiltins","commonjs","out","file","main","format","sourcemap","module","browser","build","forEach","job","rollup","then","bundle","write"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAAA,OAAO,CAACC,GAAR,CAAY,iBAAZ;AASA,IAAMC,GAAG,GAAGC,IAAI,CAACC,KAAL,CAAWC,EAAE,CAACC,YAAH,CAAgB,gBAAhB,EAAkC,MAAlC,CAAX,CAAZ;AACA,IAAMC,QAAQ,GAAG;EACfC,KAAK,EAAE;CADT;AAGA,IAAMC,IAAI,GAAGC,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBJ,QAAlB,CAAb;AACA,IAAIL,GAAG,CAACU,GAAJ,IAAWV,GAAG,CAACU,GAAJ,CAAQC,KAAvB,EAA8BH,MAAM,CAACC,MAAP,CAAcF,IAAd,EAAoBP,GAAG,CAACU,GAAJ,CAAQC,KAA5B;AAC9B,IAAMC,QAAQ,GAAGL,IAAI,CAACD,KAAtB;AAEA,IAAIO,QAAQ,GAAG,EAAf;AACA,IAAIb,GAAG,CAACc,eAAR,EAAyBD,QAAQ,CAACE,IAAT,OAAAF,QAAQ,qBAASL,MAAM,CAACQ,IAAP,CAAYhB,GAAG,CAACc,eAAhB,CAAT,EAAR;AACzB,IAAId,GAAG,CAACiB,YAAR,EAAsBJ,QAAQ,CAACE,IAAT,OAAAF,QAAQ,qBAASL,MAAM,CAACQ,IAAP,CAAYhB,GAAG,CAACiB,YAAhB,CAAT,EAAR;AACtB,IAAMC,IAAI,GAAG,CACX;EACEC,EAAE,EAAC;IACDC,KAAK,EAAER,QADN;IAEDC,QAAQ,EAARA,QAFC;IAGDQ,OAAO,EAAE,CACPC,KAAK,CAAC;MACJC,OAAO,EAAE,CACP,mBADO,CADL;MAIJC,OAAO,EAAE,KAJL;MAKJC,UAAU,EAAE,KALR;MAMJC,eAAe,EAAE,KANb;MAOJC,cAAc,EAAE;KAPb,CADE,EAUPC,OAAO,CAAC;MACNC,cAAc,EAAE;KADX,CAVA,EAaPC,QAAQ,EAbD;GAJb;EAoBEC,GAAG,EAAE,CACH;IACEC,IAAI,EAAEhC,GAAG,CAACiC,IADZ;IAEEC,MAAM,EAAE,KAFV;IAGEC,SAAS,EAAE;GAJV,EAMH;IACEH,IAAI,EAAEhC,GAAG,CAACoC,MADZ;IAEEF,MAAM,EAAE,IAFV;IAGEC,SAAS,EAAE;GATV;CArBI,EAkCX;EACEhB,EAAE,EAAC;IACDC,KAAK,EAAER,QADN;IAEDC,QAAQ,EAAEA,QAFT;IAGDQ,OAAO,EAAE,CACPC,KAAK,CAAC;MACJC,OAAO,EAAE,CACP,mBADO,CADL;MAIJC,OAAO,EAAE,KAJL;MAKJC,UAAU,EAAE,KALR;MAMJC,eAAe,EAAE,KANb;MAOJC,cAAc,EAAE;KAPb,CADE,EAUPC,OAAO,CAAC;MACNS,OAAO,EAAE;KADJ,CAVA,EAaPP,QAAQ,EAbD;GAJb;EAoBEC,GAAG,EAAE,CACH;IACEC,IAAI,EAAEhC,GAAG,CAACqC,OADZ;IAEEH,MAAM,EAAE,KAFV;IAGEC,SAAS,EAAE;GAJV;CAtDI,CAAb;;AAgEA,SAASG,KAAT,GAAiB;EACfpB,IAAI,CAACqB,OAAL,CAAa,UAACC,GAAD,EAAS;IACpBC,aAAA,CAAcD,GAAG,CAACrB,EAAlB,EAAsBuB,IAAtB,CAA2B,UAAAC,MAAM,EAAE;MACjCH,GAAG,CAACT,GAAJ,CAAQQ,OAAR,CAAgB,UAACR,GAAD,EAAS;;YAEnBA,GAAG,CAACC,IAAR,EAAcW,MAAM,CAACC,KAAP,CAAab,GAAb;OAFhB;KADF;GADF;;;AAUFO,KAAK"}