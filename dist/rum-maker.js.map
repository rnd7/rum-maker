{"version":3,"file":"rum-maker.js.map","sources":["../src/index.js"],"sourcesContent":["console.log('@rumMaker index')\n\n//import * as babel from '@babel/core'\nimport fs from 'fs'\nconst pkg = JSON.parse(fs.readFileSync('./package.json', \"utf8\"))\nconst DEFAULTS = {\n  entry: 'src/index.js',\n}\nconst opts = Object.assign({}, DEFAULTS)\nif (pkg.rum && pkg.rum.maker) Object.assign(opts, pkg.rum.maker)\n//else throw \"No rum.maker entry within package.json.\"\n\nconsole.log(opts)\n\nconst filename = opts.entry\n\n//const code = fs.readFileSync(filename, \"utf8\");\n\n/*\nbabel.transform(\n  code,\n  {\n    filename,\n    presets: [\"@babel/preset-env\"],\n    babelrc: false,\n    configFile: false,\n  },\n  (err, result) => {\n    console.log(\n      result.code,\n      result.map,\n      result.ast\n    )\n  }\n);\n*/\nimport babel from 'rollup-plugin-babel'\nimport commonjs from 'rollup-plugin-commonjs'\nimport resolve from 'rollup-plugin-node-resolve'\nimport sourcemaps from 'rollup-plugin-sourcemaps';\n//import \"@babel/polyfill\";\n\n\nlet external = []\nif (pkg.devDependencies) external.push(...Object.keys(pkg.devDependencies))\nif (pkg.dependencies) external.push(...Object.keys(pkg.dependencies))\nconst browser = !!pkg.browser\nconst main = !!pkg.main //cjs module\nconst module = !!pkg.module // esm module\n\nimport * as rollup from 'rollup'\nconst jobs = [\n  {\n    in:{\n      input: filename,\n      external,\n      plugins: [\n        sourcemaps(),\n        babel({\n          presets: [\n            \"@babel/preset-env\"\n          ],\n          babelrc: false,\n          configFile: false,\n          externalHelpers: false,\n          runtimeHelpers: true,\n          sourceMaps: true\n        }),\n        resolve({\n          preferBuiltins: true\n        }),\n        commonjs()\n      ]\n    },\n    out: [\n      {\n        file: pkg.main,\n        format: 'cjs',\n        sourcemap: true,\n        sourcemapFile: pkg.main+'.map'\n      },\n      {\n        file: pkg.module,\n        format: 'es',\n        sourcemap: true,\n        sourcemapFile: pkg.module+'.map'\n      }\n    ]\n  },\n  {\n    in:{\n      input: filename,\n      external: external,\n      plugins: [\n        babel({\n          presets: [\n            \"@babel/preset-env\"\n          ],\n          babelrc: false,\n          configFile: false,\n          externalHelpers: false,\n          runtimeHelpers: true,\n          sourceMaps: true\n        }),\n        resolve({\n          browser: true\n        }),\n        commonjs()\n      ]\n    },\n    out: [\n      {\n        file: pkg.browser,\n        format: 'cjs',\n        sourcemap: true,\n        sourcemapFile: pkg.browser+'.map'\n      }\n    ]\n  }\n\n]\n\n\n\nfunction build() {\n  // create a bundle\n  jobs.forEach((job) => {\n    rollup.rollup(job.in).then(bundle=>{\n      //console.log(bundle.imports); // an array of external dependencies\n      //console.log(bundle.exports); // an array of names exported by the entry point\n      //console.log(bundle.modules); // an array of module objects\n\n        console.log(bundle)\n      job.out.forEach((out) => {\n        bundle.generate(out).then((gen)=>{\n        //  console.log(gen)\n          if (out.file) bundle.write(out);\n        })\n      })\n    })\n  })\n    // generate code and a sourcemap\n    //const { code, map } = await\n\n  //})\n\n\n  // or write the bundle to disk\n  //await\n}\n\nbuild();\n\n\n/*\n//console.log(code)\n// Load and compile file normally, but skip code generation.\nconst { ast } = babel.transformSync(code, { filename, ast: true,\npresets: [\"@babel/preset-env\"], code: false });\nconsole.log(ast)\n// Minify the file in a second pass and generate the output code here.\nconst { code2, map } = babel.transformFromAstSync(ast, code, {\n  filename,\n  presets: [\"@babel/preset-env\"],\n  babelrc: false,\n  configFile: false,\n});\nconsole.log(code2)\n*/\n"],"names":["console","log","pkg","JSON","parse","fs","readFileSync","DEFAULTS","entry","opts","Object","assign","rum","maker","filename","external","devDependencies","push","keys","dependencies","browser","main","module","jobs","in","input","plugins","sourcemaps","babel","presets","babelrc","configFile","externalHelpers","runtimeHelpers","sourceMaps","resolve","preferBuiltins","commonjs","out","file","format","sourcemap","sourcemapFile","build","forEach","job","rollup","then","bundle","generate","gen","write"],"mappings":"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"}